name: nexus_operations

on:
  schedule:
    - cron: "0 * * * *"   # Runs every hour
  workflow_dispatch:

jobs:
  nexus:
    runs-on: ubuntu-latest

    steps:
      # 1Ô∏è‚É£ Checkout Repository
      - name: Checkout Repository
        uses: actions/checkout@v4

      # 2Ô∏è‚É£ Set up Python 3.10
      - name: Set up Python 3.10
        uses: actions/setup-python@v5
        with:
          python-version: "3.10"

      # 3Ô∏è‚É£ Install System Dependencies
      - name: Install System Dependencies
        run: |
          sudo apt-get update
          sudo apt-get install -y python3-pip
          pip install --upgrade pip
          pip install -r requirements.txt

      # 4Ô∏è‚É£ Database Schema Migration
      - name: Database Schema Migration
        run: |
          python sanity_check.py

      # 5Ô∏è‚É£ Run Maintenance
      - name: Run Maintenance
        run: |
          python maintenance.py

      # 6Ô∏è‚É£ Run Market Guardian
      - name: Run Market Guardian
        run: |
          python market_guardian.py

      # 7Ô∏è‚É£ Run AI Engine (High-Quality Mode)
      - name: Run AI Engine (High-Quality Mode)
        run: |
          python ai_engine.py
          python hybrid_engine.py
          python range_engine.py
          python nexus_core.py

      # 8Ô∏è‚É£ Run Consensus & Dispatcher
      - name: Run Consensus & Dispatcher
        run: |
          python run_consensus.py
          python nexus_dispatcher.py

      # 9Ô∏è‚É£ Run Auditor
      - name: Run Auditor
        run: |
          python audit_intelligence.py
          python recon_engine.py

      # üîü Run AI Retraining
      - name: Run AI Retraining
        run: |
          python train_brain.py

      # 1Ô∏è‚É£1Ô∏è‚É£ Commit & Push Changes
      - name: Commit & Push Changes
        run: |
          git config --global user.name "github-actions"
          git config --global user.email "actions@github.com"
          git add .
          git commit -m "üîÑ Nexus Auto Update" || echo "No changes to commit"
          git push

      # 1Ô∏è‚É£2Ô∏è‚É£ Complete Job
      - name: Complete Job
        run: echo "Nexus operation cycle complete."
