name: Nexus Intelligence Pipeline

# Runs every hour and also allows manual trigger
on:
  schedule:
    - cron: "0 * * * *"   # Every hour
  workflow_dispatch:

jobs:
  run-intelligence:
    runs-on: ubuntu-latest

    permissions:
      contents: write

    steps:
      # =========================
      # 1Ô∏è‚É£ Checkout Repository
      # =========================
      - name: Checkout Repository
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      # =========================
      # 2Ô∏è‚É£ Setup Python
      # =========================
      - name: Setup Python
        uses: actions/setup-python@v4
        with:
          python-version: "3.13"

      # =========================
      # 3Ô∏è‚É£ Install Dependencies
      # =========================
      - name: Install Dependencies
        run: |
          python -m pip install --upgrade pip
          pip install -r requirements.txt

      # =========================
      # 4Ô∏è‚É£ Run Engines
      # =========================
      - name: Run Trend Engine
        run: |
          echo "üöÄ Running Nexus Core (Trending Engine)"
          python engine/nexus_core.py

      - name: Run Range Engine
        run: |
          echo "üöÄ Running Range Engine"
          python engine/range_engine.py

      - name: Run Hybrid Engine
        run: |
          echo "üöÄ Running Hybrid Engine"
          python engine/hybrid_engine.py

      - name: Run AI Engine
        run: |
          echo "üöÄ Running AI Engine"
          python engine/ai_engine.py

      # =========================
      # 5Ô∏è‚É£ Run Consensus
      # =========================
      - name: Run Consensus
        run: |
          echo "üß† Running Consensus Engine with 4 engines"
          python engine/run_consensus.py

      # =========================
      # 6Ô∏è‚É£ Dispatch Signals
      # =========================
      - name: Dispatch Alerts
        run: |
          echo "üì£ Sending Alerts via Dispatcher"
          python engine/nexus_dispatcher.py
